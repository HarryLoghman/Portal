using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using MusicYadLibrary.Models;
using MusicYadLibrary;
using System.Data.Entity;
using System.Threading;
using System.Collections;
using System.Net.Http;
using System.Xml;
using System.Net;
using SharedLibrary;
using SharedLibrary.Models;

namespace DehnadMusicYadService
{
    public class SinglechargeInstallmentClass
    {
        static log4net.ILog logs = log4net.LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);
        private static int maxChargeLimit = 300;
        public int ProcessInstallment(int installmentCycleNumber)
        {
            var income = 0;
            try
            {
                var blackList = new List<string>() { "09303995764",
"09378573402",
"09366674007",
"09010835690",
"09359729913",
"09357027437",
"09013209626",
"09390213179",
"09021211309",
"09305963209",
"09370641865",
"09365799619",
"09389641611",
"09378429162",
"09304991961",
"09339690981",
"09014516647",
"09383329371",
"09375554508",
"09035308458",
"09373551642",
"09332916251",
"09394348738",
"09387103390",
"09030684802",
"09028314417",
"09397304834",
"09383843223",
"09335839499",
"09027871772",
"09031287412",
"09300343085",
"09361425341",
"09351677108",
"09352472202",
"09383204061",
"09337888961",
"09380345947",
"09307221314",
"09368229107",
"09361959172",
"09032220407",
"09352204468",
"09024137006",
"09334097145",
"09396779412",
"09308029887",
"09332945455",
"09332703976",
"09028618176",
"09388276199",
"09014141229",
"09381656264",
"09383556755",
"09360094936",
"09371875523",
"09373910528",
"09028460114",
"09025145313",
"09309682288",
"09032543593",
"09013083370",
"09353279185",
"09301843921",
"09333261850",
"09304235312",
"09019826053",
"09367979709",
"09358919414",
"09397306837",
"09352685595",
"09369274367",
"09396855636",
"09379630017",
"09363979901",
"09019590491",
"09031548292",
"09330322122",
"09300693668",
"09399637593",
"09035143704",
"09376102205",
"09368684380",
"09036975322",
"09335096073",
"09330916348",
"09024439133",
"09366262275",
"09307039388",
"09387943454",
"09393318142",
"09015399803",
"09352513232",
"09307995680",
"09354738747",
"09302950071",
"09370326348",
"09364950128",
"09028531507",
"09034035828",
"09396507392",
"09300636750",
"09376418547",
"09029155764",
"09302213057",
"09038076137",
"09392704539",
"09362832775",
"09384984475",
"09300815220",
"09339244799",
"09370288904",
"09039265462",
"09021777155",
"09390602440",
"09332811933",
"09333158769",
"09383612720",
"09377676273",
"09371261330",
"09025292729",
"09397659818",
"09339183220",
"09369412189",
"09033063560",
"09382638698",
"09013163188",
"09399007651",
"09333089502",
"09396688374",
"09026736235",
"09397830056",
"09351205152",
"09356250749",
"09373410502",
"09392078684",
"09381474387",
"09353214830",
"09010985837",
"09398483757",
"09338132815",
"09372808297",
"09363843960",
"09308122583",
"09375680322",
"09393893511",
"09037098624",
"09333894331",
"09039107356",
"09303019542",
"09391534625",
"09330392327",
"09024919905",
"09374072921",
"09335098893",
"09382726781",
"09388293304",
"09303387548",
"09016582526",
"09010321710",
"09339256890",
"09384252850",
"09370430633",
"09302579033",
"09385432502",
"09015173989",
"09306362068",
"09374848705",
"09362094544",
"09011710819",
"09353484249",
"09359351467",
"09355709113",
"09335959998",
"09373433559",
"09306693150",
"09334996366",
"09396904572",
"09331592705",
"09388249998",
"09370110800",
"09308369086",
"09356089686",
"09354637203",
"09334436430",
"09339774955",
"09383359678",
"09304920764",
"09391612953",
"09039079800",
"09304521640",
"09374813543",
"09375830987",
"09361687680",
"09334762707",
"09304334359",
"09392610070",
"09392548969",
"09394850601",
"09394863475",
"09396815765",
"09396895879",
"09395584620",
"09392264529",
"09397306837",
"09398378535",
"09398688021",
"09382022506",
"09383233406",
"09383417405",
"09383514386",
"09385233871",
"09388930938",
"09391074431",
"09305074303",
"09302860851",
"09303149302",
"09306015760",
"09305787287",
"09306481384",
"09306842351",
"09039774045",
"09300908200",
"09034892200",
"09013533972",
"09015206751",
"09024255536",
"09025913647",
"09030293512",
"09334776726",
"09334828529",
"09333517094",
"09336544724",
"09332911669",
"09351565826",
"09352273581",
"09354243203",
"09356305390",
"09356596954",
"09358006336",
"09361239338",
"09365814212",
"09366733601",
"09368215528",
"09370391428",
"09374852306",
"09377365954",
"09377400551",
"09380261150",
"09380116420",
"09380472288",
"09379733801",
"09380195954",
"09381300116",
"09381349413",
"09380795176",
"09381084876",
"09379410091",
"09378037178",
"09374867765",
"09373678894",
"09376870451",
"09375988107",
"09369522921",
"09372039062",
"09372260588",
"09372069629",
"09372771542",
"09373826067",
"09370454358",
"09370466559",
"09371244907",
"09371256765",
"09367074270",
"09369554967",
"09369592314",
"09369782780",
"09369971221",
"09370018929",
"09368684380",
"09368863757",
"09369064312",
"09369096196",
"09369206987",
"09366294220",
"09366433735",
"09364421963",
"09364617114",
"09364753706",
"09365101563",
"09365689087",
"09361734926",
"09363325990",
"09363434582",
"09364158959",
"09363555420",
"09361874348",
"09359469023",
"09360462264",
"09356726704",
"09351527806",
"09354369119",
"09354681227",
"09354945250",
"09353972170",
"09352948644",
"09339229423",
"09339478985",
"09339690981",
"09339801955",
"09339821087",
"09338749226",
"09338781342",
"09337189905",
"09332467417",
"09332589669",
"09331829043",
"09331832791",
"09333566575",
"09330470375",
"09331337956",
"09308679070",
"09308682284",
"09336563633",
"09336098608",
"09335972369",
"09336272006",
"09337354249",
"09337069977",
"09338132815",
"09338150796",
"09332884138",
"09332889325",
"09333091958",
"09333193148",
"09334482815",
"09335731124",
"09029560248",
"09029139663",
"09029244025",
"09028529962",
"09028535082",
"09028669599",
"09030262569",
"09031289641",
"09031319654",
"09025928820",
"09027394217",
"09027067544",
"09027831596",
"09026766540",
"09028132565",
"09024533490",
"09024868426",
"09024943323",
"09025466015",
"09025764643",
"09025817303",
"09019813116",
"09022772127",
"09021194321",
"09016597645",
"09015452856",
"09016688051",
"09019638654",
"09015399803",
"09015037320",
"09016239606",
"09013557827",
"09013562334",
"09013284848",
"09013336701",
"09013910207",
"09013720401",
"09013755344",
"09014739369",
"09010650029",
"09010731648",
"09011273835",
"09011690850",
"09012544083",
"09035181401",
"09033963925",
"09034173062",
"09031347315",
"09032827807",
"09033214318",
"09035445218",
"09035136128",
"09035760523",
"09036015046",
"09036364509",
"09300235387",
"09038411323",
"09149266337",
"09039257944",
"09037210846",
"09037262955",
"09037680102",
"09307095282",
"09308045428",
"09307387867",
"09308208530",
"09308337172",
"09303214738",
"09303328382",
"09302681167",
"09301322334",
"09301393397",
"09304847418",
"09305217483",
"09304362325",
"09303907604",
"09304673967",
"09304751983",
"09390662701",
"09392093818",
"09386051012",
"09390187882",
"09390750022",
"09388937128",
"09389053657",
"09389067663",
"09389192711",
"09389611802",
"09388359770",
"09386307719",
"09386497864",
"09385302658",
"09385341179",
"09383310105",
"09383651618",
"09383699107",
"09383577769",
"09382978093",
"09382979646",
"09383122820",
"09382440237",
"09382665611",
"09382806333",
"09382813095",
"09399046081",
"09399569393",
"09398331867",
"09398474213",
"09399101013",
"09397128293",
"09397678645",
"09397761699",
"09392220451",
"09392645634",
"09393271307",
"09393324383",
"09393625107",
"09393989194",
"09395635845",
"09396848523",
"09394954441",
"09395457290",
"09395537648",
"09359340052",
"09359465159",
"09358785404",
"09358922180",
"09358423199",
"09358432785",
"09358568028",
"09358572506",
"09358649550",
"09358087150",
"09358100696",
"09358229478",
"09358257773",
"09358263079",
"09356543785",
"09356448587",
"09355907619",
"09355961796",
"09355975811",
"09356004981",
"09356073385",
"09356106770",
"09356610425",
"09356996963",
"09357006531",
"09357214425",
"09357245860",
"09357247543",
"09357289437",
"09357554993",
"09360466516",
"09360468289",
"09360490132",
"09360526114",
"09360531197",
"09360662594",
"09359668152",
"09359775143",
"09359803749",
"09360094527",
"09360155574",
"09360265409",
"09360387745",
"09360409758",
"09361240497",
"09361261486",
"09361427005",
"09361470542",
"09361493313",
"09361496689",
"09361513934",
"09361630282",
"09360794596",
"09360888632",
"09360891941",
"09360964541",
"09361204911",
"09361231627",
"09337275619",
"09337282788",
"09339104574",
"09339130904",
"09338295066",
"09338296932",
"09338347509",
"09338397243",
"09338474672",
"09338480825",
"09338686290",
"09338818125",
"09338823407",
"09338866873",
"09338895095",
"09338928269",
"09339046079",
"09339853698",
"09339856759",
"09339675343",
"09339276420",
"09339432689",
"09351645553",
"09351897764",
"09339908761",
"09350791414",
"09351121531",
"09351161102",
"09351169306",
"09351205152",
"09351212490",
"09351468241",
"09352988493",
"09353005779",
"09353047888",
"09353064871",
"09353214830",
"09353241565",
"09353260185",
"09353388045",
"09353458375",
"09353622914",
"09353728224",
"09354074911",
"09354092227",
"09352342029",
"09352671691",
"09353892163",
"09353969828",
"09355020427",
"09355026206",
"09355163862",
"09355288703",
"09355354811",
"09355354865",
"09355378027",
"09355485486",
"09355543979",
"09355828159",
"09354837795",
"09354901030",
"09354150672",
"09354230561",
"09354392328",
"09354542127",
"09354563413",
"09335813599",
"09335864964",
"09335900870",
"09334586664",
"09334658011",
"09334707519",
"09333547296",
"09333421928",
"09333447506",
"09333503279",
"09334882090",
"09334890584",
"09334937151",
"09334969049",
"09334992352",
"09335020513",
"09335053228",
"09335184045",
"09335207008",
"09335314025",
"09335369861",
"09335388271",
"09335418455",
"09335514794",
"09335516486",
"09335565631",
"09335721753",
"09335721841",
"09338189286",
"09338276311",
"09332403464",
"09336923871",
"09337377141",
"09337402084",
"09337525003",
"09337627202",
"09337730093",
"09337886242",
"09338072049",
"09336311275",
"09336399550",
"09335979468",
"09336034966",
"09336114680",
"09336137513",
"09336264581",
"09336613803",
"09336737959",
"09336790315",
"09336863868",
"09308683044",
"09331661233",
"09331760886",
"09305965267",
"09331819476",
"09331357794",
"09331373132",
"09331430916",
"09331477596",
"09331566843",
"09331622354",
"09330470810",
"09330571890",
"09330704495",
"09330709895",
"09330777864",
"09330789435",
"09330801300",
"09330805182",
"09330913211",
"09330936316",
"09330980290",
"09331047667",
"09331136272",
"09331240030",
"09331332217",
"09333581114",
"09333617550",
"09333622061",
"09333626010",
"09333703177",
"09333756976",
"09333767341",
"09333803600",
"09333849080",
"09333894331",
"09333995384",
"09334129145",
"09334141948",
"09334145852",
"09334373954",
"09334387228",
"09331853922",
"09331875062",
"09331894061",
"09331955685",
"09332062474",
"09332117497",
"09332188497",
"09332192945",
"09332648499",
"09332691571",
"09332517685",
"09332945455",
"09332953806",
"09333005584",
"09361946430",
"09361949545",
"09362011698",
"09362156186",
"09362899770",
"09363043928",
"09363084613",
"09363135249",
"09363174302",
"09363222835",
"09362183704",
"09362252523",
"09362391660",
"09362397113",
"09362501609",
"09362526713",
"09362637741",
"09363653341",
"09363658831",
"09363752723",
"09363772993",
"09363837217",
"09363874952",
"09363942275",
"09364079005",
"09364138708",
"09364166650",
"09364179442",
"09364236305",
"09364245842",
"09363501047",
"09361778526",
"09365704909",
"09365242617",
"09365469080",
"09365490171",
"09365496563",
"09365538458",
"09365550424",
"09365554039",
"09365652001",
"09364914985",
"09364919060",
"09364649620",
"09364491929",
"09364558837",
"09366493975",
"09366007750",
"09366022625",
"09366092632",
"09366122117",
"09366127173",
"09366186467",
"09366950117",
"09367013431",
"09367019231",
"09366647166",
"09366652939",
"09366694094",
"09366728475",
"09369212068",
"09369268303",
"09369279195",
"09369350946",
"09369492456",
"09368976073",
"09368990371",
"09368701089",
"09368735682",
"09368761972",
"09368845415",
"09368224525",
"09368230891",
"09368249858",
"09368281861",
"09368342780",
"09368344946",
"09368367096",
"09368400156",
"09367114143",
"09367214792",
"09367369463",
"09367441803",
"09367569320",
"09367631728",
"09367785247",
"09367811784",
"09367864774",
"09367876921",
"09367905833",
"09367968933",
"09368213381",
"09368214300",
"09370187008",
"09370246322",
"09370323583",
"09369798124",
"09369812518",
"09369830476",
"09369882144",
"09369607124",
"09369624678",
"09369634602",
"09367086871",
"09369049337",
"09369051645",
"09371324052",
"09371438205",
"09371480312",
"09371482150",
"09371532280",
"09371682530",
"09370574081",
"09370613971",
"09370641865",
"09370680880",
"09370765881",
"09370913584",
"09371019076",
"09371088236",
"09371137187",
"09371213461",
"09373835841",
"09373861286",
"09373942556",
"09373178424",
"09373179322",
"09373315763",
"09373377473",
"09373555675",
"09373663351",
"09372839285",
"09372845107",
"09372111829",
"09358982796",
"09372750793",
"09372342540",
"09372346647",
"09372417189",
"09372430805",
"09372441319",
"09372532569",
"09372675814",
"09372715045",
"09372722498",
"09372728994",
"09372749706",
"09369527928",
"09371869013",
"09371908858",
"09371924710",
"09372018663",
"09372019514",
"09376096359",
"09376119408",
"09376151211",
"09373817493",
"09374760945",
"09374872240",
"09374956978",
"09375682214",
"09375871153",
"09376432303",
"09376582724",
"09376648531",
"09376676271",
"09376711216",
"09376790704",
"09374386745",
"09375053387",
"09375125104",
"09375365512",
"09375385964",
"09375485197",
"09375554508",
"09375651443",
"09378150865",
"09378293873",
"09378351521",
"09378359166",
"09378380110",
"09378490827",
"09378508082",
"09378573402",
"09378594468",
"09378612916",
"09378741375",
"09378828506",
"09379019471",
"09379019994",
"09379083844",
"09379461157",
"09379578545",
"09379133585",
"09379184372",
"09379207874",
"09379703467",
"09379706100",
"09377448624",
"09377662306",
"09377724716",
"09377730486",
"09377786553",
"09377849514",
"09377906894",
"09377909749",
"09377934805",
"09377985189",
"09377994414",
"09381096189",
"09381129725",
"09381686739",
"09380836433",
"09380885711",
"09380951450",
"09381435118",
"09381586639",
"09381598527",
"09381658001",
"09381674179",
"09380207089",
"09380209554",
"09379788391",
"09379924393",
"09379991374",
"09380735763",
"09380758634",
"09380131571",
"09380134645",
"09380287520",
"09380330709",
"09380403926",
"09304755328",
"09304761561",
"09304786055",
"09304798543",
"09304825328",
"09304032211",
"09304111331",
"09304114796",
"09304217152",
"09304378977",
"09304380235",
"09305235493",
"09305267760",
"09305272839",
"09305281551",
"09305293687",
"09305350043",
"09305452312",
"09305510432",
"09305512748",
"09305520654",
"09305637837",
"09305754026",
"09304987100",
"09303103238",
"09303112862",
"09305090395",
"09305098380",
"09305153757",
"09305170425",
"09301598096",
"09301615419",
"09301353946",
"09301356800",
"09300887406",
"09300901676",
"09301715367",
"09301727241",
"09301872128",
"09302076703",
"09302127504",
"09302179807",
"09302229210",
"09302236827",
"09302293390",
"09302422108",
"09302460898",
"09302500149",
"09302664723",
"09038403634",
"09302832772",
"09303012878",
"09303471399",
"09303481193",
"09303627765",
"09303639534",
"09303837237",
"09303225112",
"09303268496",
"09303303540",
"09308351653",
"09308425978",
"09308489540",
"09308534149",
"09308566711",
"09308601621",
"09308242732",
"09308297617",
"09307453931",
"09308083280",
"09308155030",
"09308199720",
"09307515801",
"09307529971",
"09307577734",
"09307666200",
"09307690117",
"09307701959",
"09308779849",
"09308964323",
"09308975384",
"09308978016",
"09308993918",
"09309029194",
"09309115438",
"09309185697",
"09309223281",
"09309575067",
"09309625485",
"09309666289",
"09309707764",
"09309945161",
"09330141351",
"09330145893",
"09330222325",
"09330314630",
"09307120568",
"09307159872",
"09307215177",
"09307303077",
"09307306482",
"09306877997",
"09306913980",
"09306945586",
"09307023732",
"09307063391",
"09307739248",
"09307756768",
"09307786755",
"09307857130",
"09307962541",
"09308017931",
"09308029887",
"09308038065",
"09306633815",
"09306754352",
"09304310610",
"09305215020",
"09306124081",
"09306153018",
"09306211844",
"09306238413",
"09306278439",
"09306290940",
"09306398489",
"09306456212",
"09037802859",
"09037803978",
"09037844602",
"09037865380",
"09037933092",
"09037953993",
"09037966838",
"09037966994",
"09038006133",
"09038030964",
"09038225871",
"09038264347",
"09037264981",
"09037298649",
"09037306688",
"09037331308",
"09037344929",
"09037415288",
"09039103322",
"09039126675",
"09039139362",
"09039153803",
"09039160867",
"09039202724",
"09039235445",
"09039252871",
"09037583925",
"09037601128",
"09037608898",
"09037616380",
"09038655953",
"09038677433",
"09038781990",
"09038982977",
"09039006912",
"09039071382",
"09039078301",
"09039262497",
"09039457263",
"09039506032",
"09039616875",
"09039661795",
"09039680264",
"09039719262",
"09151702192",
"09158347323",
"09038598584",
"09039870900",
"09058925310",
"09300013353",
"09300234280",
"09300952366",
"09301087178",
"09301191178",
"09301308477",
"09300445229",
"09300445918",
"09300449081",
"09300518983",
"09300543786",
"09300571923",
"09300652441",
"09300726518",
"09300744978",
"09300799632",
"09300878165",
"09034890918",
"09036357353",
"09035900131",
"09035930645",
"09035947432",
"09035971756",
"09035976266",
"09036404580",
"09036736029",
"09036836197",
"09036911250",
"09036957445",
"09037098624",
"09037126646",
"09037133629",
"09036038224",
"09036073786",
"09036080579",
"09036096079",
"09036174856",
"09036329056",
"09035798457",
"09035167568",
"09035448139",
"09035493997",
"09035714065",
"09033241059",
"09033536599",
"09033585139",
"09033598092",
"09033707632",
"09033751104",
"09033812479",
"09032849065",
"09032914793",
"09033090733",
"09033168375",
"09031534186",
"09031682557",
"09031689965",
"09034181924",
"09034544633",
"09034705983",
"09034799564",
"09033966955",
"09033969148",
"09033976656",
"09034038404",
"09034092183",
"09035330635",
"09035363217",
"09035397990",
"09035401218",
"09035420225",
"09035015507",
"09035027167",
"09035109763",
"09012570071",
"09012765421",
"09011768846",
"09011784010",
"09011819112",
"09011833813",
"09011853728",
"09011886617",
"09011959300",
"09011976185",
"09012303152",
"09011361584",
"09011446625",
"09011522812",
"09011586560",
"09010804539",
"09010806136",
"09010891258",
"09010891371",
"09010145596",
"09010157731",
"09010183570",
"09010199460",
"09010225502",
"09010285724",
"09010319898",
"09010336634",
"09010499173",
"09010624261",
"09014781841",
"09014880743",
"09014959392",
"09013662817",
"09013665357",
"09013665564",
"09013967445",
"09013995175",
"09014139094",
"09014421614",
"09014429605",
"09014573742",
"09014610121",
"09014632346",
"09014663086",
"09013467261",
"09013306055",
"09012841518",
"09012845622",
"09012846076",
"09012973994",
"09012974168",
"09012990361",
"09013083370",
"09013136995",
"09013163188",
"09013255773",
"09016293124",
"09016373401",
"09016393803",
"09015667548",
"09015708024",
"09015717532",
"09015927262",
"09015989900",
"09016123817",
"09015115920",
"09015128585",
"09014698190",
"09014719190",
"09015405733",
"09015317208",
"09016915870",
"09016917654",
"09016922329",
"09016953461",
"09017015026",
"09017039847",
"09017056676",
"09017100450",
"09017113586",
"09017177925",
"09017203832",
"09017258600",
"09017329178",
"09017364870",
"09017366185",
"09017474006",
"09017701715",
"09017921495",
"09017940608",
"09019751707",
"09018270227",
"09018285815",
"09018332442",
"09018398601",
"09019032842",
"09019197342",
"09019433627",
"09019437793",
"09019626432",
"09016798856",
"09016609487",
"09016622081",
"09016653509",
"09021211309",
"09021239916",
"09021585655",
"09022002720",
"09019855663",
"09019920816",
"09019934368",
"09019940385",
"09019984631",
"09021002308",
"09021013400",
"09023334512",
"09024247813",
"09024282186",
"09024346267",
"09025854467",
"09025865752",
"09025485032",
"09025529480",
"09025606258",
"09025655838",
"09026262183",
"09026278115",
"09026342258",
"09026345925",
"09026403708",
"09026533551",
"09026549410",
"09026736235",
"09026755975",
"09024879889",
"09024935241",
"09025138237",
"09025143599",
"09025336429",
"09025361873",
"09024626602",
"09024672061",
"09024695785",
"09024739603",
"09024376793",
"09024404220",
"09024412740",
"09024438252",
"09024468128",
"09024531951",
"09028135172",
"09028159137",
"09028215101",
"09028297408",
"09026778239",
"09027560747",
"09027639135",
"09027829085",
"09027865886",
"09027884713",
"09028013168",
"09028027760",
"09028043785",
"09028049276",
"09028130510",
"09027091209",
"09027099359",
"09027106660",
"09027129581",
"09027135414",
"09027172765",
"09027200320",
"09027217394",
"09027303308",
"09027312740",
"09027320856",
"09027389138",
"09027445605",
"09027481959",
"09016557439",
"09025436583",
"09031344979",
"09030290530",
"09030485802",
"09030599813",
"09030638466",
"09030648746",
"09030844980",
"09030846501",
"09030897875",
"09030903692",
"09030934877",
"09031057252",
"09031062957",
"09031248492",
"09031263300",
"09031284658",
"09031839942",
"09031851261",
"09031894368",
"09031930354",
"09031932372",
"09031990180",
"09031996521",
"09032069296",
"09032341627",
"09032388566",
"09032443496",
"09032560073",
"09032566072",
"09032595851",
"09032661295",
"09032740713",
"09032795458",
"09028733709",
"09028919265",
"09028970664",
"09028980011",
"09028981312",
"09029075187",
"09029077319",
"09028542960",
"09028601327",
"09028659324",
"09028354691",
"09028373513",
"09028376577",
"09028411721",
"09029480420",
"09029511488",
"09029511739",
"09029522022",
"09029546881",
"09029158890",
"09029170955",
"09029227112",
"09029580756",
"09029602384",
"09029759855",
"09030161079",
"09030175807",
"09030241866",
"09030431954",
"09030458159",
"09396424604",
"09396535830",
"09394871017",
"09396640961",
"09396647581",
"09396652062",
"09396918172",
"09396924333",
"09397059437",
"09397125026",
"09395831880",
"09395856410",
"09395933170",
"09395956083",
"09396052984",
"09395059065",
"09395071829",
"09395195254",
"09395207221",
"09395250049",
"09395261405",
"09395359396",
"09395407897",
"09394092068",
"09394129678",
"09394174519",
"09394205195",
"09394212571",
"09394322033",
"09393649348",
"09393737688",
"09393751155",
"09393808309",
"09393864331",
"09392575514",
"09394424182",
"09393446931",
"09393487459",
"09392981511",
"09393005775",
"09393125124",
"09393126777",
"09393133229",
"09392787989",
"09392885934",
"09392203106",
"09392367854",
"09392419528",
"09397786464",
"09397793627",
"09397807852",
"09397825348",
"09397829121",
"09397835062",
"09397721714",
"09398052497",
"09394741443",
"09397379500",
"09397386058",
"09397436804",
"09397555747",
"09397659068",
"09397670405",
"09399126036",
"09399212112",
"09399233221",
"09399413923",
"09399473278",
"09399483213",
"09399524667",
"09399535285",
"09399568381",
"09398486175",
"09398677191",
"09398422102",
"09398435065",
"09398368131",
"09399673429",
"09399687279",
"09399063276",
"09398712761",
"09398755591",
"09399762541",
"09399781192",
"09399810225",
"09399841303",
"09399864068",
"09399884229",
"09399906207",
"09382887693",
"09382927470",
"09382963119",
"09382459112",
"09381821777",
"09381939902",
"09381946414",
"09382015726",
"09382277812",
"09382320651",
"09382344779",
"09382417271",
"09382433735",
"09383139834",
"09383162107",
"09383221131",
"09383039860",
"09383042832",
"09383054791",
"09383089568",
"09383619208",
"09383238524",
"09382505311",
"09382552049",
"09383782290",
"09385119137",
"09385198443",
"09383692100",
"09382656901",
"09385525927",
"09385647798",
"09385695391",
"09385706421",
"09385763440",
"09385910939",
"09383986436",
"09384039312",
"09384108288",
"09384197868",
"09384261995",
"09384278696",
"09384305894",
"09384327513",
"09384435170",
"09384578301",
"09384603874",
"09384625429",
"09384705133",
"09384785046",
"09384814168",
"09384895351",
"09384983190",
"09386509778",
"09386717771",
"09387078138",
"09387252287",
"09387430108",
"09387440409",
"09387453851",
"09387455086",
"09387834904",
"09387953290",
"09387956694",
"09387965681",
"09388079509",
"09388144768",
"09388276199",
"09388293304",
"09388298028",
"09388361748",
"09388398650",
"09388614426",
"09388706913",
"09388826675",
"09388840445",
"09388842985",
"09388901904",
"09389623675",
"09389717155",
"09390768771",
"09390855731",
"09390246061",
"09390257041",
"09390360773",
"09390544209",
"09390560161",
"09390159161",
"09386062410",
"09387612406",
"09392096279",
"09392159435",
"09390737950",
"09390966804",
"09391099633",
"09391209403",
"09391266431",
"09391405147",
"09391407915",
"09391454843",
"09391530178",
"09391599411",
"09391647799",
"09391891301",
"09391901899",
"09391912931",
"09392078128",
"09391031382",
"09387824490",
"09389878473",
"09385090419",
"09396573124",
"09028969862",
"09027550689",
"09019821733",
"09015549486",
"09016444867",
"09013658381",
"09014665643",
"09036856475",
"09306456217",
"09305171542",
"09379107256",
"09374754740",
"09372208424",
"09374127955",
"09374215523",
"09366506310",
"09366451795",
"09308768362",
"09338280966",
"09353794308",
"09350684644",
"09361080473",
"09356820859",
"09358678244",
"09358976440",
"09358363500",
"09358142615",
"09356464751",
"09360927578",
"09360786362",
"09339872599",
"09339088321",
"09339212077",
"09354093592",
"09355902897",
"09337092415",
"09338072236",
"09338112848",
"09336866064",
"09336682051",
"09333259368",
"09335859296",
"09331777882",
"09331654391",
"09332216172",
"09364673511",
"09365222833",
"09365251377",
"09362663739",
"09362873871",
"09362168337",
"09371722281",
"09367096614",
"09368403205",
"09369001241",
"09373098148",
"09372040183",
"09372750030",
"09373774992",
"09374868526",
"09375661189",
"09375048892",
"09376240119",
"09376356641",
"09379649593",
"09380247967",
"09381679723",
"09381770216",
"09304386430",
"09304237779",
"09303044482",
"09303059116",
"09302767241",
"09301689226",
"09305947423",
"09306796062",
"09330355374",
"09307713727",
"09307485764",
"09036385502",
"09035811027",
"09036337562",
"09035126151",
"09034130129",
"09034802856",
"09031819898",
"09031581276",
"09300884512",
"09300330494",
"09300381267",
"09038618108",
"09160557660",
"09037569187",
"09038341098",
"09013880240",
"09011218431",
"09012305295",
"09012390653",
"09011819655",
"09012790905",
"09012738547",
"09016166331",
"09017980984",
"09016810534",
"09018313274",
"09024348217",
"09026245852",
"09028301753",
"09025365842",
"09025126219",
"09025735061",
"09028703660",
"09030468796",
"09030874058",
"09395010372",
"09396120699",
"09392960846",
"09394497909",
"09394339853",
"09399978863",
"09399714270",
"09398394940",
"09397685220",
"09397978604",
"09397830322",
"09385102588",
"09383926428",
"09382644647",
"09382464918",
"09382260808",
"09390218084",
"09390625907",
"09390936784",
"09390952223",
"09392163898",
"09392096145",
"09389730010",
"09387519086",
"09034925467",
"09037343693",
"09037934088",
"09305808665",
"09332260961",
"09019796712",
"09025212064",
"09013595174",
"09033062613",
"09336955427",
"09386945268",
"09381623148",
"09381884691",
"09398422102",
"09377641918",
"09358448868",
"09361867271",
"09362493804",
"09364661160",
"09366217035",
"09370444807",
"09381085929",
"09381170885",
"09338997664",
"09339033139",
"09011396776",
"09384035861",
"09388222600",
"09391651857",
"09395691250",
"09397606949",
"09033534365",
"09033808296",
"09014679831",
"09027391806",
"09027407713",
"09028690778",
"09029118673",
"09333599205",
"09334310508",
"09307790151",
"09304222803",
"09304786055",
"09037644766"};
                string aggregatorName = Properties.Settings.Default.AggregatorName;
                var serviceCode = Properties.Settings.Default.ServiceCode;
                var serviceAdditionalInfo = SharedLibrary.ServiceHandler.GetAdditionalServiceInfoForSendingMessage(serviceCode, aggregatorName);
                List<SinglechargeInstallment> installmentList;
                Type entityType = typeof(MusicYadEntities);
                Type singleChargeType = typeof(Singlecharge);

                using (var entity = new MusicYadEntities())
                {
                    entity.Configuration.AutoDetectChangesEnabled = false;
                    List<ImiChargeCode> chargeCodes = ((IEnumerable)SharedLibrary.ServiceHandler.GetServiceImiChargeCodes(entity)).OfType<ImiChargeCode>().ToList();
                    for (int installmentInnerCycleNumber = 1; installmentInnerCycleNumber <= 2; installmentInnerCycleNumber++)
                    {
                        logs.Info("start of installmentInnerCycleNumber " + installmentInnerCycleNumber);
                        installmentList = ((IEnumerable)SharedLibrary.InstallmentHandler.GetInstallmentList(entity)).OfType<SinglechargeInstallment>().ToList();
                        var date = DateTime.Parse("2018-03-09 00:00:00");
                        if(DateTime.Now.Date < date.Date)
                        {
                            var a = new List<SinglechargeInstallment>();
                            foreach (var item in installmentList)
                            {
                                if (!blackList.Contains(item.MobileNumber))
                                    a.Add(item);
                            }
                            installmentList.Clear();
                            installmentList = a;
                        }
                        int installmentListCount = installmentList.Count;
                        var installmentListTakeSize = Properties.Settings.Default.DefaultSingleChargeTakeSize;
                        SharedLibrary.InstallmentHandler.MtnInstallmentJob(entityType, maxChargeLimit, installmentCycleNumber, installmentInnerCycleNumber, serviceCode, chargeCodes, installmentList, installmentListCount, installmentListTakeSize, serviceAdditionalInfo, singleChargeType);
                        logs.Info("end of installmentInnerCycleNumber " + installmentInnerCycleNumber);
                    }
                }
            }
            catch (Exception e)
            {
                logs.Error("Exception in ProcessInstallment:", e);
            }
            return income;
        }
    }
}
